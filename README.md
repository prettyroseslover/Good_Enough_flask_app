### Исправленное веб-приложение на Flask

Для простоты минимально заполненная БД приведена вместе с исходным кодом.
Запуск:

```
flask --app app run
```

#### Противостояние XSS 

В xss.html изменили с:

```
{% autoescape false %}
{{ request.args.get('search') }}
{% endautoescape %}
```

На: 

```
{% autoescape true %}
{{ request.args.get('search') }}
{% endautoescape %}
```

Т.е. включили экранирование.

Теперь ничего опасного не происходит при попытке отправить запрос типа: 

```
<script>alert("e he he")</script>
```

#### Противостояние IDOR

На странице /idor реализована минимальная аутентификация. Как только предоставлены валидные логин и пароль, пользователю устанавливается session_token и он пападает на персональную страницу. При нажатии кнопки "Выйти" токен удаляется и процедуру можно будет пройти заново. Реализовано разграничение для пользователей для исключения IDOR.

#### Противостояние SQLI

Везде для работы с БД используется SQLAlchemy - ORM. При обращении к БД везде используются готовые функции, а не конкатенация запроса и данных, введенных пользователем. 

Теперь запросы типа admin' OR '1'='1 не работают.

#### Противостояние OS command injection

Захардкожено корректное использование ping c помощью: 

```
cmd = ["ping", "-c", "3", hostname]
result = subprocess.Popen(cmd, shell=False, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.DEVNULL, close_fds=True).communicate()[0]
```

#### Противостояние Path Traversal

Добавим валидацию/санитизацию параметра img, который получаем от пользователя - будем "вытаскивать" только имя файла, обрезая путь (потенциальный traversal через ../../ и т.п.). Будем считать, что пользователю доступны только файлы из директории static/img, но ничего более. Если он введет ../..//..//../////../etc/passwd, то будет осуществлен поиск файла passwd в директории static/img. Этого файла там нет, поэтому вернется ошибка 404. 

Валидация/санитизация осуществляется с помощью: 
```
os.path.basename(request.args.get('img'))
```

#### Противостояние Brute Force

Добавили rate limiter - flask_limiter.
Для /bruteforce поставили лимит 5 запросов в минуту.
Теперь, если запустить скрипт подбора пароля, то  он обработает только 5 запросов в минуту. На все последующие он вернет ошибку - 429 Too Many Requests.
